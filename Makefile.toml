[tasks.BUILD]
description = "Build project for development"
script = ['''
#!/bin/bash
cargo build --features "bevy/dynamic_linking pause"
''']

[tasks.DEV]
description = "Run project for development"
script = ['''
#!/bin/bash
cargo run --features "bevy/dynamic_linking pause"
''']

[tasks.windowsDEV]
description = "Run project for development on windows"
condition = { platforms = ["windows"] }
args = ["cargo", "run", "--features", "'bevy/dynamic_linking pause'"]
command = "powershell"

[tasks.wasmDEV]
description = "Run project for development"
script = ['''
#!/bin/bash
cargo run --target wasm32-unknown-unknown --features bevy/dynamic_linking pause
''']

[tasks.wasm-phoneDEV]
description = "Run project for development on phone"
script = ['''
#!/bin/bash
cargo run --target wasm32-unknown-unknown --features bevy/dynamic_linking pause phone
''']

[tasks.BETA]
description = "Build project for beta"
script = ['''
#!/bin/bash
cargo build --release --features pause
''']

[tasks.windowsBETA]
description = "Run project for beta on windows"
condition = { platforms = ["windows"] }
args = ["cargo", "build", "--release", "--features", "pause"]
command = "powershell"

[tasks.RELEASE]
description = "Build project for release"
script = ['''
#/bin/bash
cargo build --release
''']

[tasks.wasmRELEASE]
description = "Build project for release"
script = ['''
#/bin/bash
cargo build --target wasm32-unknown-unknown --release
''']

[tasks.wasm-phoneRELEASE]
description = "Build project for release on phone"
script = ['''
#/bin/bash
cargo build --target wasm32-unknown-unknown --release --features phone
''']

[tasks.windowsRELEASE]
description = "Build project for release on windows"
condition = { platforms = ["windows"] }
args = ["--target", "--release"]
command = "powershell"

[tasks.wasmDEPLOY]
description = "create wasm directory to deploy, and launch the local server to test"
script = ['''
#!/bin/bash
mv ./docs/phone ./phone
rm -r ./docs/*
wasm-bindgen --no-typescript --target web --out-dir ./docs --out-name "dynamicarena" ./target/wasm32-unknown-unknown/release/dynamicarena.wasm
mkdir ./docs/assets
mv ./phone ./docs/phone
cp -r assets/fonts ./docs/assets/fonts
cp -r assets/images ./docs/assets/images
rm -r docs/assets/images/phone
cp -r assets/sounds ./docs/assets/sounds
cp ./wasm_build/index.html docs/index.html

temp_file=$(mktemp)
cat ./wasm_build/enable_sound.js ./docs/dynamicarena.js > $temp_file
mv $temp_file ./docs/dynamicarena.js

cd docs
python3 -m http.server 8000
''']

[tasks.wasm-phoneDEPLOY]
description = "create wasm directory to deploy, and launch the local server to test"
script = ['''
#!/bin/bash
rm -r ./docs/phone/*
wasm-bindgen --no-typescript --target web --out-dir ./docs/phone --out-name "dynamicarena" ./target/wasm32-unknown-unknown/release/dynamicarena.wasm
mkdir ./docs/phone/assets
cp -r assets/fonts ./docs/phone/assets/fonts
cp -r assets/images/phone ./docs/phone/assets/images
cp assets/images/background.png ./docs/phone/assets/images
cp assets/images/background_mainmenu.png ./docs/phone/assets/images
cp -r assets/sounds ./docs/phone/assets/sounds
cp ./wasm_build/index.html docs/phone/index.html

temp_file=$(mktemp)
cat ./wasm_build/enable_sound.js ./docs/phone/dynamicarena.js > $temp_file
mv $temp_file ./docs/phone/dynamicarena.js

cd docs
python3 -m http.server 8000
''']
